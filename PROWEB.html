<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Formulario de Datos</title>
  <link rel="stylesheet" href="CSS.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.8/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
</head>
<body>
  <form>
    <label for="codigo">Código:</label>
    <input type="text" id="codigo" name="codigo"><br><br>
    <label for="nombre">Nombre:</label>
    <input type="text" id="nombre" name="nombre"><br><br>
    <label for="apellido">Apellido:</label>
    <input type="text" id="apellido" name="apellido"><br><br>
    <label for="fecha">Fecha:</label>
    <input type="date" id="fecha" name="fecha"><br><br>
    <label for="correo">Correo:</label>
    <input type="email" id="correo" name="correo"><br><br>	
    <input type="button" value="Agregar" onclick="agregarDatos()">
    <input type="button" value="Actualizar" onclick="actualizarDatos()">
    <input type="button" value="Eliminar" onclick="eliminarDatos()">
    <input type="button" value="Limpiar" onclick="limpiarFormulario()">
  </form>

  <div id="tablaDatos"></div>

  <div>
    <label for="buscarCodigo">Buscar Código:</label>
    <input type="text" id="buscarCodigo">
    <input type="button" value="Buscar" onclick="buscarCodigo()">
    <div id="resultadoBusqueda"></div>
  </div>

  <script>
        let datos = [];

        function agregarDatos() {
            const codigo = document.getElementById("codigo").value;
            const nombre = document.getElementById("nombre").value;
            const apellido = document.getElementById("apellido").value;
            const fecha = document.getElementById("fecha").value;
            const correo = document.getElementById("correo").value;

            if (codigo && nombre && apellido && fecha && correo) {
                datos.push({ Código: codigo, Nombre: nombre, Apellido: apellido, Fecha: fecha, Correo: correo });
                document.getElementById("codigo").value = "";
                document.getElementById("nombre").value = "";
                document.getElementById("apellido").value = "";
                document.getElementById("fecha").value = "";
                document.getElementById("correo").value = "";
                mostrarDatos();
            } else {
                alert("Por favor complete todos los campos.");
            }
        }

        function limpiar()
        {
            document.getElementById("codigo").value="";
            document.getElementById("nombre").value="";
            document.getElementById("apellido").value="";
            document.getElementById("fecha").value="";
            document.getElementById("correo").value="";
        }

        function mostrarDatos() {
            const tabla = document.getElementById("tablaDatos");
            tabla.innerHTML = "";

            if (datos.length > 0) {
                const table = document.createElement("table");
                const headerRow = table.insertRow(0);

                for (const key in datos[0]) {
                    const th = document.createElement("th");
                    th.innerHTML = key;
                    headerRow.appendChild(th);
                }

                for (let i = 0; i < datos.length; i++) {
                    const row = table.insertRow(i + 1);
                    for (const key in datos[i]) {
                        const cell = row.insertCell();
                        cell.innerHTML = datos[i][key];
                    }
                }

                tabla.appendChild(table);
                document.getElementById("exportButton").style.display = "block";
            } else {
                document.getElementById("exportButton").style.display = "none";
            }
        }

        function buscarCodigo() {
            const codigoBuscado = document.getElementById("buscarCodigo").value;
            const resultadoBusqueda = document.getElementById("resultadoBusqueda");
            resultadoBusqueda.innerHTML = "";

            if (codigoBuscado) {
                const resultados = datos.filter((item) => item["Código"] === codigoBuscado);

                if (resultados.length > 0) {
                    const table = document.createElement("table");
                    const headerRow = table.insertRow(0);

                    for (const key in resultados[0]) {
                        const th = document.createElement("th");
                        th.innerHTML = key;
                        headerRow.appendChild(th);
                    }

                    resultados.forEach((item, index) => {
                        const row = table.insertRow(index + 1);
                        for (const key in item) {
                            const cell = row.insertCell();
                            cell.innerHTML = item[key];
                        }
                    });

                    resultadoBusqueda.appendChild(table);

                    // Mostrar los datos encontrados en las cajas de texto del formulario
                    document.getElementById("codigo").value = resultados[0]["Código"];
                    document.getElementById("nombre").value = resultados[0]["Nombre"];
                    document.getElementById("apellido").value = resultados[0]["Apellido"];
                    document.getElementById("fecha").value = resultados[0]["Fecha"];
                    document.getElementById("correo").value = resultados[0]["Correo"];
                } else {
                    resultadoBusqueda.innerHTML = "Código no encontrado.";
                }
            }
        }

        function actualizarDatos() {
            const codigo = document.getElementById("codigo").value;
            const nombre = document.getElementById("nombre").value;
            const apellido = document.getElementById("apellido").value;
            const fecha = document.getElementById("fecha").value;
            const correo = document.getElementById("correo").value;

            if (codigo) {
                const indice = datos.findIndex((item) => item["Código"] === codigo);

                if (indice !== -1) {
                    datos[indice] = { Código: codigo, Nombre: nombre, Apellido: apellido, Fecha: fecha, Correo: correo };
                    mostrarDatos();
                    limpiarFormulario();
                }
            }
        }

        function eliminarDatos() {
            const codigo = document.getElementById("codigo").value;

            if (codigo) {
                const indice = datos.findIndex((item) => item["Código"] === codigo);

                if (indice !== -1) {
                    datos.splice(indice, 1);
                    mostrarDatos();
                    limpiarFormulario();
                }
            }
        }

        function limpiarFormulario() {
            document.getElementById("codigo").value = "";
            document.getElementById("nombre").value = "";
            document.getElementById("apellido").value = "";
            document.getElementById("fecha").value = "";
            document.getElementById("correo").value = "";
        }

       
</script>
</body>
</html>
